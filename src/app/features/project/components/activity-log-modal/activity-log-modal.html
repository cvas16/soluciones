<div *ngIf="isVisible" class="modal-backdrop" (click)="close()">
  <div class="modal-dialog" (click)="$event.stopPropagation()">

    <div class="modal-content">
      <div class="modal-header">
        <h5><i class="bi bi-clock-history me-2"></i>Historial del Proyecto</h5>
        <button class="close-btn" (click)="close()">Ã—</button>
      </div>

      <div class="modal-body p-0"> <div *ngIf="isLoading" class="text-center p-4">
          <div class="spinner-border text-primary" role="status"></div>
        </div>

        <div *ngIf="!isLoading && logs.length === 0" class="text-center text-muted p-5">
          <i class="bi bi-inbox fs-1 d-block mb-2"></i>
          No hay actividad reciente.
        </div>

        <div *ngIf="!isLoading && logs.length > 0" class="activity-feed p-3">

          <div *ngFor="let log of logs" class="feed-item">
            <div class="feed-icon">
              <i class="bi" [ngClass]="getIconForAction(log.action)"></i>
            </div>

            <div class="feed-content">
              <div class="d-flex justify-content-between align-items-start">
                <span class="fw-bold text-dark user-name">{{ log.userName }}</span>
                <span class="text-muted small date-text">{{ getTimeAgo(log.timestamp) }}</span>
              </div>

              <p class="mb-0 text-secondary log-desc">{{ log.description }}</p>

              <small class="text-muted fst-italic" *ngIf="log.taskId">
                Ref: Tarea #{{ log.taskId }}
              </small>
            </div>
          </div>

        </div>

      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary w-100" (click)="close()">Cerrar</button>
      </div>
    </div>

  </div>
</div>

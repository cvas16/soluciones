<div class="projects-page">

  <div class="page-header">
    <div class="header-content">
      <div class="header-left">
        <h1 class="page-title">
          <span class="title-icon">📊</span> Mis Proyectos
        </h1>
        <p class="page-subtitle">Gestiona y organiza todos tus proyectos en un solo lugar</p>
      </div>
      <button class="btn btn-create" (click)="createNewProject()" [disabled]="isCreatingProject">
        <span *ngIf="!isCreatingProject">
          <span class="btn-icon">+</span> Crear Proyecto
        </span>
        <span *ngIf="isCreatingProject" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        <span *ngIf="isCreatingProject"> Creando...</span>
      </button>
    </div>
  </div>

  <app-spinner *ngIf="isLoading" message="Cargando proyectos..."></app-spinner>

  <div *ngIf="errorMessage" class="alert alert-danger">
    <span class="alert-icon">⚠️</span>
    {{ errorMessage }}
  </div>

  <div *ngIf="!isLoading && !errorMessage" class="projects-section">
    <div *ngIf="projects.length > 0; else noProjects">

      <div class="section-header">
        <h2 class="section-title">
          <span class="section-icon">🕒</span> Proyectos Recientes
        </h2>
        <span class="projects-count">{{ projects.length }} proyecto(s)</span>
      </div>

      <div class="projects-grid">
        <div *ngFor="let project of projects; let i = index"
             class="project-card"
             [style.animation-delay]="(i * 0.1) + 's'">

          <div class="project-content">
             <h3 class="project-name">
               <a [routerLink]="['/project', project.id]">{{ project.name }}</a>
             </h3>
             <div class="project-meta">
                <span class="project-meta-item">
                  <span class="meta-icon">📋</span>
                  <span class="meta-text">0 tareas</span>
                </span>
                <span class="project-meta-item">
                  <span class="meta-icon">👥</span>
                  <span class="meta-text">1 miembro</span>
                </span>
             </div>

            <div class="project-footer">
              <button class="btn btn-view" [routerLink]="['/project', project.id]">
                <span class="btn-icon">👁️</span>
                Ver Proyecto
              </button>

              <button class="btn btn-delete"
                      (click)="openDeleteModal(project)"
                      [disabled]="deletingProjectId === project.id">
                <span *ngIf="deletingProjectId !== project.id" class="btn-icon">🗑️</span>
                <span *ngIf="deletingProjectId === project.id" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
              </button>

            </div>
          </div>
        </div>

        <div class="project-card project-card-create" (click)="createNewProject()">
           </div>
      </div>
    </div>

    <ng-template #noProjects>
      <div class="empty-state">
         </div>
    </ng-template>
  </div>
</div>

<app-modal
  [isVisible]="showDeleteModal"
  title="Confirmar Eliminación"
  confirmType="danger"
  (closed)="onModalClose()"
  (confirmed)="onModalConfirm()">

  <p>¿Estás seguro de que quieres eliminar el proyecto
     <strong>"{{ projectToDeleteName }}"</strong>?
  </p>
  <p class="text-danger fw-bold">Esta acción no se puede deshacer.</p>

</app-modal>
